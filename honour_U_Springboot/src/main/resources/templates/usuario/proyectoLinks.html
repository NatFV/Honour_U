<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
<head>
    <title>Enlaces del Proyecto</title>
    <th:block layout:fragment="extra_head">
        <style>
            .copy { cursor: pointer; }
        </style>
    </th:block>
</head>
<body>
<section layout:fragment="content">
    <h2 th:text="'Proyecto creado: ' + ${proyecto.nombreProyecto}">Proyecto creado</h2>

    <div class="mb-3">
        <label class="form-label">Enlace para aportaciones (compártelo):</label>
        <div class="input-group">
            <input class="form-control" type="text" readonly th:value="${linkAportaciones}">
            <button class="btn btn-outline-secondary copy" data-target="aport">Copiar</button>
        </div>
    </div>

    <div class="mb-3">
        <label class="form-label">Enlace del organizador (¡privado!):</label>
        <div class="input-group">
            <input class="form-control" type="text" readonly th:value="${linkAdmin}">
            <button class="btn btn-outline-secondary copy" data-target="admin">Copiar</button>
        </div>
        <div class="form-text text-danger">
            Con este enlace podrás ordenar páginas, ocultar/mostrar y generar el PDF.
        </div>
    </div>

    <div class="d-flex gap-2">
        <a class="btn btn-primary" th:href="@{${linkAdmin}}">Abrir panel del organizador</a>
        <a class="btn btn-outline-secondary" th:href="@{${linkAportaciones}}">Abrir enlace público</a>
    </div>

    <script>
        document.addEventListener('click', async (e) => {
            const btn = e.target.closest('.copy');
            if (!btn) return;
            const input = btn.previousElementSibling;
            input.select();
            try {
                await navigator.clipboard.writeText(input.value);
                btn.textContent = 'Copiado';
                setTimeout(() => btn.textContent = 'Copiar', 1200);
            } catch {
                document.execCommand('copy'); // fallback antiguo
            }
        });
    </script>
</section>
</body>
</html>
